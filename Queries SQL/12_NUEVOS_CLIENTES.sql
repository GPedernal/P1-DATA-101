USE ODS;
/*DESCUBRIMOS LOS CLIENTES NUEVOS*/


SELECT DISTINCT PRO.CUSTOMER_ID
FROM STAGE.STG_PRODUCTOS_CRM PRO 
LEFT OUTER JOIN ODS_HC_CLIENTES CLI
ON PRO.CUSTOMER_ID = CLI.ID_CLIENTE
WHERE CLI.ID_CLIENTE IS NULL;
/*
Y LOS AÃ‘ADIMOS A LA TABLA*/
INSERT INTO ODS_HC_CLIENTES VALUES (16689, 'DESCONOCIDO', 'DESCONOCIDO', '99-999-9999', 99, 999999, 9999999999, 'DESCONOCIDO', STR_TO_DATE('31/12/9999','%d/%m/%Y'), 999, 999, NOW(),STR_TO_DATE('31/12/9999','%d/%m/%Y'))
;
INSERT INTO ODS_HC_CLIENTES VALUES (10000, 'DESCONOCIDO', 'DESCONOCIDO', '99-999-9999', 99, 999999, 9999999999, 'DESCONOCIDO', STR_TO_DATE('31/12/9999','%d/%m/%Y'), 999, 999, NOW(),STR_TO_DATE('31/12/9999','%d/%m/%Y'))
;
INSERT INTO ODS_HC_CLIENTES VALUES (14826, 'DESCONOCIDO', 'DESCONOCIDO', '99-999-9999', 99, 999999, 9999999999, 'DESCONOCIDO', STR_TO_DATE('31/12/9999','%d/%m/%Y'), 999, 999, NOW(),STR_TO_DATE('31/12/9999','%d/%m/%Y'))
;

COMMIT;
